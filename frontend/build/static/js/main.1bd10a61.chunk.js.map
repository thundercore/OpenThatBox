{"version":3,"sources":["App/assets/box-closed.png","App/contexts/Web3Context/Web3Context.tsx","config.ts","App/components/Blockie/Blockie.tsx","App/components/Header/Header.tsx","App/contexts/MinerContractContext/MinerContractContext.tsx","App/components/LoginForm/LoginForm.tsx","App/utils/parseMinerLog.ts","App/service/GameService.ts","App/components/CanvasGame/CanvasGame.tsx","App/components/ScoreDisplay/ScoreDisplay.tsx","App/components/GameLoader/GameLoader.tsx","App/components/App/App.tsx","serviceWorker.ts","index.tsx"],"names":["module","exports","Web3Context","React","createContext","setCode","code","sendAll","address","provider","JsonRpcProvider","isValid","signer","undefined","Web3Provider","children","rpcUrl","useState","myProvider","pollingInterval","setSigner","setValid","useEffect","getBalance","then","val","gt","bigNumberify","console","log","a","balance","lt","parseEther","alert","sendTransaction","to","value","sub","trans","wait","Provider","toLowerCase","hdNode","fromSeed","sha256","toUtf8Bytes","join","Wallet","connect","useWeb3Context","useContext","config","process","memo","props","color","spot","rest","data","useMemo","blockies","seed","bgcolor","size","scale","spotcolor","toDataURL","src","useStyles","makeStyles","theme","createStyles","container","justifyContent","title","fontSize","fontFamily","fontWeight","classes","AppBar","position","Toolbar","className","Typography","variant","Button","href","target","Box","display","alignItems","mr","height","width","Context","isLoading","error","MinerContractProvider","contract","setContract","setLoading","setError","contractAddress","Contract","abi","deployed","catch","e","useMinerContractContext","setCodeVal","pt","TextField","fullWidth","onChange","evt","label","disabled","onClick","parseMinerLog","x","y","total","toNumber","initialized","Tile","Direction","GameService","isMoving","stateUpdate","Subject","currentUser","image","characters","gameState","map","getCurrentUser","playerPositions","spotColor","Promise","all","this","state","user","makeMap","createImage","joinGame","Mined","loadHistoricalData","watchMovement","Array","fill","Unmined","handleEvent","character","next","on","playerJoinedFilter","filters","PlayerJoined","fromBlock","toBlock","playerMovedFilter","PlayerMoved","getLogs","joinedLogs","concat","forEach","values","interface","parseLog","userAddress","Math","abs","direction","move","Down","canMove","callMove","Up","Left","Right","TileSize","service","ref","useRef","BoxImage","Image","BoxClosed","viewPortX","viewPortY","drawCharacters","ctx","bounds","Object","boundsXLow","boundsXHigh","boundsYLow","boundsYHigh","drawImage","drawUser","requestAnimationFrame","drawGame","current","getContext","clearRect","round","dx","dy","lineWidth","strokeStyle","strokeRect","drawMap","drawCurrentUser","keyPressHandler","useCallback","key","window","addEventListener","removeEventListener","scoreBox","padding","borderRadius","left","transition","transitions","create","border","setState","setAddress","subscribe","random","mb","mt","sort","c1","c2","slice","idx","style","top","component","parseFloat","formatEther","duration","stepPrecision","ml","initialize","CircularProgress","minWidth","stop","Boolean","location","hostname","match","ReactDOM","render","createMuiTheme","palette","background","default","primary","main","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.1bd10a61.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/box-closed.3f0598f3.png\";","import React, { ReactNode, useContext, useEffect, useState } from 'react'\nimport { Signer, Wallet } from 'ethers'\nimport {\n  JsonRpcProvider,\n  Web3Provider as EthersProvider,\n} from 'ethers/providers'\nimport { fromSeed } from 'ethers/utils/hdnode'\nimport {\n  BigNumber,\n  bigNumberify,\n  parseEther,\n  sha256,\n  toUtf8Bytes,\n} from 'ethers/utils'\nimport { sign } from 'crypto'\n\ninterface IWeb3ContextProps {\n  children: ReactNode\n  rpcUrl: string\n}\n\nexport interface IWeb3Context {\n  setCode(code: string): void\n  sendAll(address: string): void\n  signer?: Signer\n  provider: JsonRpcProvider\n  address: string\n  isValid: boolean\n}\n\nconst Web3Context = React.createContext<IWeb3Context>({\n  setCode: (code: string) => {},\n  sendAll: (address: string) => {},\n  provider: new JsonRpcProvider(''),\n  address: '',\n  isValid: false,\n  signer: undefined,\n})\n\nexport default function Web3Provider({ children, rpcUrl }: IWeb3ContextProps) {\n  const [provider] = useState(() => {\n    const myProvider = new JsonRpcProvider(rpcUrl)\n    myProvider.pollingInterval = 400\n    return myProvider\n  })\n  const [signer, setSigner] = useState<Wallet | undefined>()\n  const [isValid, setValid] = useState(true)\n\n  const setCode = (code: string) => {\n    const hdNode = fromSeed(\n      sha256('0x' + toUtf8Bytes(code + 'thunder').join(''))\n    )\n    setSigner(new Wallet(hdNode).connect(provider))\n  }\n\n  useEffect(\n    () => {\n      if (signer) {\n        setValid(true)\n        signer.getBalance().then((val) => {\n          setValid(val.gt(bigNumberify(0)))\n        })\n      }\n    },\n    [signer]\n  )\n  console.log(signer && signer.address)\n\n  const sendAll = async (address: string) => {\n    try {\n      const balance = await signer!.getBalance()\n      if (balance.lt(parseEther('0.001'))) {\n        alert('TT has already been sent')\n      } else {\n        const trans = await signer!.sendTransaction({\n          to: address,\n          value: balance.sub(bigNumberify(parseEther('0.001'))),\n        })\n\n        await trans.wait()\n        alert('Sent!')\n      }\n    } catch (e) {\n      alert('Invalid Address or TT has already been sent')\n    }\n  }\n\n  return (\n    <Web3Context.Provider\n      value={{\n        provider,\n        signer,\n        isValid,\n        address: signer ? signer.address.toLowerCase() : '',\n        setCode,\n        sendAll,\n      }}\n    >\n      {children}\n    </Web3Context.Provider>\n  )\n}\n\nexport const useWeb3Context = () => useContext(Web3Context)\n","export const config = {\n  rpcUrl: process.env.REACT_APP_RPC_URL!,\n  contractAddress: process.env.REACT_APP_CONTRACT_ADDRESS!,\n}\n","import React, { useMemo } from 'react'\n//@ts-ignore\nimport * as blockies from 'blockies'\n\ninterface IBlockieProps\n  extends React.DetailedHTMLProps<\n      React.ImgHTMLAttributes<HTMLImageElement>,\n      HTMLImageElement\n    > {\n  address: string\n  color: string\n  spot?: boolean\n}\n\nexport default React.memo(function Blockie(props: IBlockieProps) {\n  const { address, color, spot, ...rest } = props\n  const data = useMemo(\n    () =>\n      blockies({\n        seed: address,\n        color,\n        bgcolor: '#00000000',\n        size: 6,\n        scale: 4,\n        spotcolor: spot ? undefined : '#00000000',\n      }).toDataURL(),\n    [address]\n  )\n  return <img {...rest} src={data} />\n})\n","import React from 'react'\nimport {\n  AppBar,\n  Box,\n  createStyles,\n  makeStyles,\n  Theme,\n  Toolbar,\n  Typography,\n} from '@material-ui/core'\nimport { useWeb3Context } from '../../contexts/Web3Context/Web3Context'\nimport Blockie from '../Blockie/Blockie'\nimport Button from '@material-ui/core/Button'\n\nconst useStyles = makeStyles<Theme, IHeaderProps>((theme: Theme) =>\n  createStyles({\n    container: {\n      justifyContent: 'space-between',\n    },\n    title: {\n      fontSize: 22,\n      fontFamily: 'Courier',\n      fontWeight: 700,\n    },\n  })\n)\n\ninterface IHeaderProps {}\n\nexport default React.memo(function Header(props: IHeaderProps) {\n  const classes = useStyles(props)\n  const { address, isValid } = useWeb3Context()\n\n  return (\n    <AppBar position={'relative'}>\n      <Toolbar className={classes.container}>\n        <Typography variant=\"h6\" className={classes.title}>\n          Open That Box\n        </Typography>\n        {address &&\n          isValid && (\n            <Button\n              href={'https://scan.thundercore.com/address/' + address}\n              target={'_blank'}\n            >\n              <Box display={'flex'} alignItems={'center'}>\n                <Box mr={1}>\n                  <Typography>{address}</Typography>\n                </Box>\n                <Blockie\n                  spot\n                  address={address}\n                  height={24}\n                  width={24}\n                  color={'black'}\n                />\n              </Box>\n            </Button>\n          )}\n      </Toolbar>\n    </AppBar>\n  )\n})\n","import React, { ReactNode, useContext, useEffect, useState } from 'react'\nimport { Contract } from 'ethers'\nimport { abi } from './Miner.json'\nimport { useWeb3Context } from '../Web3Context/Web3Context'\n\ninterface IContractContextProps {\n  children?: ReactNode\n  contractAddress: string\n}\n\ninterface IContractContext {\n  contract?: Contract\n  isLoading: boolean\n  error: boolean\n}\n\nconst Context = React.createContext<IContractContext>({\n  isLoading: false,\n  error: false,\n})\n\nexport default function MinerContractProvider(props: IContractContextProps) {\n  const [contract, setContract] = useState<Contract | undefined>()\n  const [isLoading, setLoading] = useState(false)\n  const [error, setError] = useState(false)\n  const { contractAddress } = props\n\n  const { signer, provider } = useWeb3Context()\n\n  useEffect(\n    () => {\n      if (contractAddress && signer) {\n        setLoading(true)\n        setError(false)\n        try {\n          const contract = new Contract(contractAddress, abi as any, signer)\n          contract\n            .deployed()\n            .then((contract) => {\n              setLoading(false)\n              setContract(contract)\n            })\n            .catch((a: any) => {\n              console.log(a)\n              setLoading(false)\n              setError(true)\n              setContract(undefined)\n            })\n        } catch (e) {\n          setLoading(false)\n          setError(true)\n          setContract(undefined)\n        }\n      }\n    },\n    [signer, contractAddress]\n  )\n\n  return (\n    <Context.Provider value={{ contract, isLoading, error }}>\n      {props.children}\n    </Context.Provider>\n  )\n}\n\nexport const useMinerContractContext = () => useContext(Context)\n","import React, { ReactNode, useState } from 'react'\nimport {\n  Box,\n  Button,\n  CircularProgress,\n  createStyles,\n  makeStyles,\n  TextField,\n  Theme,\n} from '@material-ui/core'\nimport { useWeb3Context } from '../../contexts/Web3Context/Web3Context'\nimport { useMinerContractContext } from '../../contexts/MinerContractContext/MinerContractContext'\n\nconst useStyles = makeStyles<Theme, ILoginFormProps>((theme: Theme) =>\n  createStyles({})\n)\n\ninterface ILoginFormProps {\n  children: ReactNode\n}\n\nexport default React.memo(function LoginForm(props: ILoginFormProps) {\n  const classes = useStyles(props)\n  const { setCode, isValid, address } = useWeb3Context()\n  const { contract, isLoading } = useMinerContractContext()\n  const [code, setCodeVal] = useState('')\n\n  const handleClick = () => {\n    setCode(code)\n  }\n  const isLoggedIn = isValid && address && !!contract\n\n  return !isLoggedIn ? (\n    <Box\n      display={'flex'}\n      pt={8}\n      alignItems={'center'}\n      justifyContent={'center'}\n    >\n      <Box mr={2} width={400}>\n        <TextField\n          fullWidth\n          color={'inherit'}\n          variant={'filled'}\n          error={!!address && !isValid}\n          onChange={(evt) => setCodeVal(evt.target.value)}\n          label={!!address && !isValid ? 'Invalid Code' : 'Code'}\n        />\n      </Box>\n      <Button\n        color=\"primary\"\n        variant={'contained'}\n        disabled={isLoading}\n        onClick={handleClick}\n      >\n        Login\n      </Button>\n    </Box>\n  ) : (\n    <div>{props.children}</div>\n  )\n})\n","import { BigNumber } from 'ethers/utils'\n\nexport function parseMinerLog(\n  address: string,\n  x: BigNumber,\n  y: BigNumber,\n  value: BigNumber,\n  total: BigNumber\n) {\n  return {\n    address: address.toLowerCase(),\n    x: x.toNumber(),\n    y: y.toNumber(),\n    total: total,\n    initialized: true,\n  }\n}\n","import { Contract } from 'ethers'\nimport { parseMinerLog } from '../utils/parseMinerLog'\n//@ts-ignore\nimport * as blockies from 'blockies'\nimport { BigNumber, bigNumberify } from 'ethers/utils'\nimport { Subject } from 'rxjs'\n\nexport enum Tile {\n  Unmined,\n  Mined,\n  Treasure,\n}\n\nexport interface ICharacter {\n  image: string\n  x: number\n  y: number\n  address: string\n  initialized: boolean\n  total: BigNumber\n}\n\nexport enum Direction {\n  Left,\n  Right,\n  Down,\n  Up,\n}\n\nexport class GameService {\n  isMoving = false\n  size: number = 0\n  stateUpdate = new Subject()\n\n  currentUser: ICharacter = {\n    image: '',\n    total: bigNumberify(0),\n    x: 0,\n    y: 0,\n    address: 'fake',\n    initialized: false,\n  }\n  characters: { [key: string]: ICharacter } = {}\n  gameState: number = 0\n  map: any[][] = []\n\n  constructor(\n    private readonly contract: Contract,\n    private readonly address: string\n  ) {}\n\n  private createImage(address: string, spotColor?: boolean) {\n    return blockies({\n      seed: address,\n      color: 'black',\n      bgcolor: '#00000000',\n      size: 6,\n      scale: 4,\n      spotcolor: spotColor ? undefined : '#00000000',\n    }).toDataURL()\n  }\n\n  getCurrentUser = async () => {\n    const position = await this.contract.playerPositions(this.address)\n    return {\n      x: position.x.toNumber(),\n      y: position.y.toNumber(),\n      initialized: position.initialized,\n    }\n  }\n\n  async initialize() {\n    const [user, size, state] = await Promise.all([\n      this.getCurrentUser(),\n      this.contract.size(),\n      this.contract.state(),\n    ])\n    this.size = size.toNumber()\n    this.map = this.makeMap(this.size)\n\n    this.currentUser = {\n      total: bigNumberify(0),\n      address: this.address,\n      image: this.createImage(this.address, true),\n      ...user,\n    }\n\n    if (!this.currentUser.initialized) {\n      const trans = await this.contract.joinGame()\n      await trans.wait()\n      this.currentUser = {\n        ...this.currentUser,\n        ...(await this.getCurrentUser()),\n      }\n    }\n    this.map[this.currentUser.x][this.currentUser.y] = Tile.Mined\n    this.gameState = state\n    await this.loadHistoricalData()\n    this.watchMovement()\n  }\n\n  private makeMap(size: number) {\n    return Array(size)\n      .fill(Tile.Unmined)\n      .map((x) => Array(size).fill(Tile.Unmined))\n  }\n\n  private watchMovement() {\n    const handleEvent = (\n      address: string,\n      x: BigNumber,\n      y: BigNumber,\n      val: BigNumber,\n      total: BigNumber\n    ) => {\n      address = address.toLowerCase()\n      const character = parseMinerLog(address, x, y, val, total)\n      if (address !== this.address) {\n        this.characters[address] = {\n          ...character,\n          image: this.characters[address]\n            ? this.characters[address].image\n            : this.createImage(address),\n        }\n        this.map[character.x][character.y] = Tile.Mined\n      } else {\n        this.currentUser.total = character.total\n      }\n      this.stateUpdate.next()\n    }\n    this.contract.on('PlayerJoined', handleEvent)\n    this.contract.on('PlayerMoved', handleEvent)\n    this.contract.on('GameStarted', () => {\n      this.gameState = 1\n      this.stateUpdate.next()\n    })\n    this.contract.on('GameEnded', () => {\n      this.gameState = 2\n      this.stateUpdate.next()\n    })\n  }\n\n  private async loadHistoricalData() {\n    const playerJoinedFilter = {\n      ...this.contract.filters.PlayerJoined(),\n      fromBlock: '0x0',\n      toBlock: 'latest',\n    }\n    const playerMovedFilter = {\n      ...this.contract.filters.PlayerMoved(),\n      fromBlock: '0x0',\n      toBlock: 'latest',\n    }\n    const joinedLogs = await this.contract.provider.getLogs(playerJoinedFilter)\n    const logs = joinedLogs.concat(\n      await this.contract.provider.getLogs(playerMovedFilter)\n    )\n    logs.forEach((log) => {\n      const { values } = this.contract.interface.parseLog(log)\n      const userAddress = values[0].toLowerCase()\n      const character = {\n        ...parseMinerLog(\n          userAddress,\n          values[1],\n          values[2],\n          values[3],\n          values[4]\n        ),\n      }\n      if (userAddress !== this.address) {\n        this.characters[userAddress] = {\n          ...character,\n          image: this.createImage(userAddress),\n        }\n      } else {\n        this.currentUser.total = character.total\n      }\n      this.map[character.x][character.y] = Tile.Mined\n    })\n  }\n\n  canMove(x: number, y: number) {\n    return (\n      this.gameState === 1 &&\n      x >= 0 &&\n      y >= 0 &&\n      x < this.size &&\n      y < this.size &&\n      Math.abs(this.currentUser.x - x) + Math.abs(this.currentUser.y - y) === 1\n    )\n  }\n\n  async callMove(direction: Direction) {\n    const trans = await this.contract.move(direction)\n    await trans.wait()\n  }\n\n  async move(direction: Direction) {\n    console.log('move', direction)\n    const { x, y } = this.currentUser\n    if (this.isMoving) {\n      return\n    }\n    this.isMoving = true\n    try {\n      if (direction === Direction.Down && this.canMove(x, y + 1)) {\n        this.currentUser.y += 0.4\n        await this.callMove(Direction.Down)\n        this.currentUser.y = y + 1\n      } else if (direction === Direction.Up && this.canMove(x, y - 1)) {\n        this.currentUser.y -= 0.4\n        await this.callMove(Direction.Up)\n        this.currentUser.y = y - 1\n      } else if (direction === Direction.Left && this.canMove(x - 1, y)) {\n        this.currentUser.x -= 0.4\n        await this.callMove(Direction.Left)\n        this.currentUser.x = x - 1\n      } else if (direction === Direction.Right && this.canMove(x + 1, y)) {\n        this.currentUser.x += 0.4\n        await this.callMove(Direction.Right)\n        this.currentUser.x = x + 1\n      }\n      this.map[this.currentUser.x][this.currentUser.y] = Tile.Mined\n      this.isMoving = false\n    } catch (e) {\n      this.isMoving = false\n      this.currentUser.y = y\n      this.currentUser.x = x\n    }\n  }\n}\n","import React, { useEffect, useRef } from 'react'\nimport { createStyles, makeStyles, Theme } from '@material-ui/core'\nimport {\n  Direction,\n  GameService,\n  ICharacter,\n  Tile,\n} from '../../service/GameService'\nimport BoxClosed from '../../assets/box-closed.png'\n\nconst useStyles = makeStyles<Theme, ICanvasGameProps>((theme: Theme) =>\n  createStyles({})\n)\n\ninterface ICanvasGameProps {\n  service: GameService\n  stop: boolean\n}\n\nconst TileSize = 32\n\nexport default React.memo(function CanvasGame(props: ICanvasGameProps) {\n  const classes = useStyles(props)\n  const { service } = props\n  const ref = useRef<any>()\n  const BoxImage = new Image()\n  BoxImage.src = BoxClosed\n\n  const viewPortX = 29\n  const viewPortY = 19\n\n  function drawMap(\n    ctx: CanvasRenderingContext2D,\n    bounds: any,\n    currentUser: ICharacter\n  ) {\n    for (let x = bounds.boundsXLow; x <= bounds.boundsXHigh; x++) {\n      for (let y = bounds.boundsYLow; y <= bounds.boundsYHigh; y++) {\n        const dx = (x - currentUser.x + viewPortX / 2) * TileSize\n        const dy = (y - currentUser.y + viewPortY / 2) * TileSize\n        ctx.lineWidth = 2\n        ctx.strokeStyle = 'black'\n        ctx.strokeRect(dx, dy, TileSize, TileSize)\n        if (service.map[x][y] === Tile.Unmined) {\n          ctx.drawImage(BoxImage, dx + 5, dy + 5, 20, 20)\n        }\n      }\n    }\n  }\n\n  function drawCharacters(\n    ctx: CanvasRenderingContext2D,\n    bounds: any,\n    currentUser: ICharacter\n  ) {\n    const { characters } = service\n    Object.values(characters).forEach((user) => {\n      if (\n        user.x >= bounds.boundsXLow &&\n        user.x <= bounds.boundsXHigh &&\n        user.y >= bounds.boundsYLow &&\n        user.y <= bounds.boundsYHigh\n      ) {\n        drawUser(ctx, user, currentUser)\n      }\n    })\n  }\n\n  function drawUser(\n    ctx: CanvasRenderingContext2D,\n    user: ICharacter,\n    currentUser: ICharacter\n  ) {\n    const image = new Image()\n    image.src = user.image\n    ctx.drawImage(\n      image,\n      (user.x - currentUser.x + viewPortX / 2) * TileSize + 6,\n      (user.y - currentUser.y + viewPortY / 2) * TileSize + 6,\n      20,\n      20\n    )\n  }\n\n  function drawCurrentUser(ctx: CanvasRenderingContext2D, user: ICharacter) {\n    const image = new Image()\n    image.src = user.image\n    // always in the center\n    ctx.drawImage(\n      image,\n      (viewPortX * TileSize) / 2 + 6,\n      (viewPortY * TileSize) / 2 + 6,\n      20,\n      20\n    )\n  }\n\n  function drawGame() {\n    if (!ref.current) {\n      return\n    }\n    const ctx: CanvasRenderingContext2D = ref.current.getContext('2d')\n    ctx.clearRect(0, 0, viewPortX * TileSize, viewPortY * TileSize)\n    const { currentUser } = service\n    // always in the middle\n    let boundsXLow =\n      Math.round(currentUser.x) - 15 < 0 ? 0 : Math.round(currentUser.x) - 15\n    let boundsXHigh =\n      Math.round(currentUser.x) + 14 > service.size - 1\n        ? service.size - 1\n        : Math.round(currentUser.x) + 14\n    let boundsYLow =\n      Math.round(currentUser.y) - 10 < 0 ? 0 : Math.round(currentUser.y) - 10\n    let boundsYHigh =\n      Math.round(currentUser.y) + 10 > service.size - 1\n        ? service.size - 1\n        : Math.round(currentUser.y) + 10\n\n    boundsXHigh =\n      boundsXHigh > service.size - 1 ? service.size - 1 : boundsXHigh\n    boundsXLow = boundsXLow < 0 ? 0 : boundsXLow\n    boundsYHigh =\n      boundsYHigh > service.size - 1 ? service.size - 1 : boundsYHigh\n    boundsYLow = boundsYLow < 0 ? 0 : boundsYLow\n    const bounds = { boundsXHigh, boundsXLow, boundsYHigh, boundsYLow }\n\n    drawMap(ctx, bounds, service.currentUser)\n\n    drawCharacters(ctx, bounds, service.currentUser)\n    drawCurrentUser(ctx, service.currentUser)\n\n    requestAnimationFrame(drawGame)\n  }\n  requestAnimationFrame(drawGame)\n\n  const keyPressHandler = React.useCallback(\n    (evt: KeyboardEvent) => {\n      if (evt.key === 'ArrowDown' || evt.key === 's') {\n        service.move(Direction.Down)\n      } else if (evt.key === 'ArrowUp' || evt.key === 'w') {\n        service.move(Direction.Up)\n      } else if (evt.key === 'ArrowLeft' || evt.key === 'a') {\n        service.move(Direction.Left)\n      } else if (evt.key === 'ArrowRight' || evt.key === 'd') {\n        service.move(Direction.Right)\n      }\n    },\n    [service]\n  )\n\n  useEffect(\n    () => {\n      window.addEventListener('keydown', keyPressHandler)\n      // Remove event listeners on cleanup\n      return () => {\n        window.removeEventListener('keydown', keyPressHandler)\n      }\n    },\n    [keyPressHandler]\n  )\n\n  return (\n    <canvas\n      ref={ref}\n      width={viewPortX * TileSize}\n      height={viewPortY * TileSize}\n    />\n  )\n})\n","import React, { useEffect, useState } from 'react'\nimport {\n  Button,\n  createStyles,\n  makeStyles,\n  TextField,\n  Theme,\n} from '@material-ui/core'\nimport { GameService } from '../../service/GameService'\nimport Box from '@material-ui/core/Box'\nimport Blockie from '../Blockie/Blockie'\nimport Typography from '@material-ui/core/Typography'\n//@ts-ignore\nimport AnimatedNumber from 'react-animated-number'\nimport { formatEther } from 'ethers/utils'\nimport { useWeb3Context } from '../../contexts/Web3Context/Web3Context'\n\nconst useStyles = makeStyles<Theme, IScoreDisplayProps>((theme: Theme) =>\n  createStyles({\n    scoreBox: {\n      width: 250,\n      padding: 8,\n      borderRadius: 4,\n      height: 50,\n      position: 'absolute',\n      left: 0,\n      transition: theme.transitions.create('all'),\n      border: '1px solid black  ',\n    },\n  })\n)\n\ninterface IScoreDisplayProps {\n  service: GameService\n}\n\nexport default React.memo(function ScoreDisplay(props: IScoreDisplayProps) {\n  const classes = useStyles(props)\n  const { sendAll } = useWeb3Context()\n  const [test, setState] = useState(1)\n  const [address, setAddress] = useState('')\n\n  useEffect(\n    () => {\n      props.service.stateUpdate.subscribe(() => {\n        setState(Math.random())\n      })\n    },\n    [props.service]\n  )\n\n  return (\n    <div>\n      {props.service.gameState == 2 && (\n        <Box\n          display={'flex'}\n          pt={8}\n          mb={2}\n          alignItems={'center'}\n          justifyContent={'center'}\n        >\n          <Box mr={2} width={250}>\n            <TextField\n              fullWidth\n              color={'inherit'}\n              variant={'filled'}\n              label={'Send To Address'}\n              onChange={(evt) => setAddress(evt.target.value)}\n            />\n          </Box>\n          <Button\n            color=\"primary\"\n            variant={'contained'}\n            onClick={() => sendAll(address)}\n          >\n            Send\n          </Button>\n        </Box>\n      )}\n      {props.service.gameState == 0 && (\n        <Typography>WAITING FOR PLAYERS</Typography>\n      )}\n      {props.service.gameState == 1 && <Typography>GAME STARTED</Typography>}\n      {props.service.gameState == 2 && <Typography>GAME OVER</Typography>}\n      <Box position={'relative'} mt={2}>\n        {Object.values(props.service.characters)\n          .sort((c1, c2) => (c2.total.gt(c1.total) ? 1 : -1))\n          .slice(0, 10)\n          .concat([props.service.currentUser])\n          .sort((c1, c2) => (c2.total.gt(c1.total) ? 1 : -1))\n          .map(({ address, total }, idx) => (\n            <Box\n              key={address}\n              display={'flex'}\n              alignItems={'center'}\n              className={classes.scoreBox}\n              style={{\n                top: idx * 50,\n              }}\n            >\n              <Box mr={2}>\n                <Blockie\n                  address={address}\n                  color={'black'}\n                  spot={address === props.service.currentUser.address}\n                />\n              </Box>\n              <AnimatedNumber\n                component={Typography}\n                value={parseFloat(formatEther(total))}\n                variant={'h6'}\n                duration={500}\n                stepPrecision={8}\n              />\n              <Box ml={1}>\n                <Typography>\n                  <b>TT</b>\n                </Typography>\n              </Box>\n            </Box>\n          ))}\n      </Box>\n    </div>\n  )\n})\n","import React, { useEffect, useState } from 'react'\nimport {\n  CircularProgress,\n  createStyles,\n  makeStyles,\n  Theme,\n  Typography,\n} from '@material-ui/core'\nimport { useWeb3Context } from '../../contexts/Web3Context/Web3Context'\nimport { useMinerContractContext } from '../../contexts/MinerContractContext/MinerContractContext'\nimport CanvasGame from '../CanvasGame/CanvasGame'\nimport { GameService } from '../../service/GameService'\nimport Box from '@material-ui/core/Box'\nimport ScoreDisplay from '../ScoreDisplay/ScoreDisplay'\n\nconst useStyles = makeStyles<Theme, IGameLoaderProps>((theme: Theme) =>\n  createStyles({})\n)\n\ninterface IGameLoaderProps {}\n\nexport default React.memo(function GameLoader(props: IGameLoaderProps) {\n  const contractContext = useMinerContractContext()\n  const contract = contractContext.contract!\n  const { address } = useWeb3Context()\n  const [service] = useState(new GameService(contract, address))\n  const [isLoading, setLoading] = useState(true)\n  const [error, setError] = useState(false)\n  useEffect(\n    () => {\n      service\n        .initialize()\n        .then(() => setLoading(false))\n        .catch((a) => {\n          console.log(a)\n          setError(true)\n        })\n    },\n    [service]\n  )\n\n  if (error) {\n    return <Typography>Please Refresh the Page and Try again</Typography>\n  }\n  return isLoading ? (\n    <Box\n      display={'flex'}\n      alignItems={'center'}\n      mt={10}\n      justifyContent={'center'}\n    >\n      <CircularProgress />\n    </Box>\n  ) : (\n    <Box display={'flex'} mt={6} justifyContent={'center'}>\n      <Box minWidth={300} mr={4} position={'relative'}>\n        <ScoreDisplay service={service} />\n      </Box>\n      <Box>\n        <CanvasGame service={service} stop={false} />\n      </Box>\n    </Box>\n  )\n})\n","import React from 'react'\nimport { createStyles, makeStyles, Theme } from '@material-ui/core'\nimport Web3Provider from '../../contexts/Web3Context/Web3Context'\nimport { config } from '../../../config'\nimport Header from '../Header/Header'\nimport MinerContractProvider from '../../contexts/MinerContractContext/MinerContractContext'\nimport LoginForm from '../LoginForm/LoginForm'\nimport GameLoader from '../GameLoader/GameLoader'\n\nconst useStyles = makeStyles<Theme, IAppProps>((theme: Theme) =>\n  createStyles({})\n)\n\ninterface IAppProps {}\n\nexport default React.memo(function App(props: IAppProps) {\n  const classes = useStyles(props)\n  return (\n    <Web3Provider rpcUrl={config.rpcUrl}>\n      <MinerContractProvider contractAddress={config.contractAddress}>\n        <Header />\n        <LoginForm>\n          <GameLoader />\n        </LoginForm>\n      </MinerContractProvider>\n    </Web3Provider>\n  )\n})\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App/components/App/App'\nimport CssBaseline from '@material-ui/core/CssBaseline/CssBaseline'\nimport { unregister } from './serviceWorker'\nimport { createMuiTheme, MuiThemeProvider } from '@material-ui/core'\n\nReactDOM.render(\n  <MuiThemeProvider\n    theme={createMuiTheme({\n      palette: {\n        background: {\n          default: '#edeceb',\n        },\n        primary: {\n          main: '#ffe81c',\n        },\n      },\n    })}\n  >\n    <CssBaseline>\n      <App />\n    </CssBaseline>\n  </MuiThemeProvider>,\n  document.getElementById('root')\n)\n\nunregister()\n"],"sourceRoot":""}